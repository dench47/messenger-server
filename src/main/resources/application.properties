# ===== SERVER CONFIG =====
server.port=8080
server.tomcat.max-threads=200
server.tomcat.max-connections=10000
server.tomcat.keep-alive-timeout=30000
server.tomcat.connection-timeout=30000

# ===== DATABASE CONFIG =====
spring.datasource.url=jdbc:mysql://localhost:3306/messenger_db?useSSL=false&serverTimezone=UTC&allowPublicKeyRetrieval=true&useUnicode=true&characterEncoding=UTF-8&connectionTimeout=30000&socketTimeout=60000
spring.datasource.username=messenger_user
spring.datasource.password=strong_password_123
spring.datasource.driver-class-name=com.mysql.cj.jdbc.Driver
spring.datasource.hikari.maximum-pool-size=20
spring.datasource.hikari.minimum-idle=5
spring.datasource.hikari.connection-timeout=30000
spring.datasource.hikari.idle-timeout=600000
spring.datasource.hikari.max-lifetime=1800000

# ===== JPA CONFIG =====
spring.jpa.database-platform=org.hibernate.dialect.MySQL8Dialect
spring.jpa.hibernate.ddl-auto=update
spring.jpa.show-sql=false
spring.jpa.properties.hibernate.format_sql=false
spring.jpa.properties.hibernate.jdbc.batch_size=20
spring.jpa.properties.hibernate.order_inserts=true
spring.jpa.properties.hibernate.order_updates=true
spring.jpa.properties.hibernate.query.fail_on_pagination_over_collection_fetch=true

# ===== REDIS CONFIG (for 5000+ sessions) =====
spring.data.redis.host=localhost
spring.data.redis.port=6379
spring.data.redis.timeout=5000ms
spring.data.redis.lettuce.pool.max-active=30
spring.data.redis.lettuce.pool.max-idle=15
spring.data.redis.lettuce.pool.min-idle=5
spring.data.redis.lettuce.pool.max-wait=2000ms
spring.data.redis.lettuce.shutdown-timeout=100ms

# ===== RABBITMQ CONFIG (STOMP Broker) - ?????????? =====
spring.rabbitmq.host=localhost
spring.rabbitmq.port=5672
spring.rabbitmq.username=guest
spring.rabbitmq.password=guest
spring.rabbitmq.connection-timeout=10000

# ??????? 1: ?????????? CONNECTION cache mode (????????????? ??? WebSocket)
spring.rabbitmq.cache.connection.mode=connection
spring.rabbitmq.cache.connection.size=20
spring.rabbitmq.cache.channel.size=100

# ??????? 2: ??? ?????????? CHANNEL mode, ?? ????? ??????? connection.size
# spring.rabbitmq.cache.connection.mode=channel
# spring.rabbitmq.cache.channel.size=100
# ??????: spring.rabbitmq.cache.connection.size=20

spring.rabbitmq.template.receive-timeout=5000
spring.rabbitmq.template.reply-timeout=5000

# ===== JWT CONFIG =====
jwt.secret=mySuperSecretKeyForMessengerApplication2024ThatIsVeryLongAndSecureForHS512AlgorithmAndMustBeAtLeast64CharactersLongForSecurity
jwt.access.expiration=3600000
jwt.refresh.expiration=2592000000

# ===== ACTUATOR (Spring Boot 3.1+) - ????????? =====
management.endpoints.web.exposure.include=health,info,metrics,prometheus
management.endpoint.health.show-details=when_authorized

# ===== METRICS CONFIGURATION - ????????? =====
management.metrics.enable.jvm=true
management.metrics.enable.system=true
management.metrics.enable.tomcat=true



# ===== WEBSOCKET BUFFER SIZES =====
spring.websocket.send-buffer-size-limit=524288
spring.websocket.send-time-limit=20000

# ===== APPLICATION CONFIG =====
spring.main.allow-circular-references=true
spring.main.banner-mode=console
spring.main.lazy-initialization=false

# ===== SPRING SECURITY =====
spring.security.filter.order=10